# Lab1_12012505_占陈郅

### Introduction

The purpose of this lab is that 

- Review DSP tools to be used later in speech signal processing
- Filter design
- Varying sampling rate,
- etc.



### Lab results and Analysis

##### Problem 1

![image-20230221094156865](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230221094156865.png)

<center> Fig.1 Results of PlotAudioFile</center>

Function *PlotAudioFile* is written by using for loop to plot the signal for 4 rows each page.

```matlab
function PlotAudioFile(audiowav,fstart,M,N)

[y,Fs] = audioread(audiowav);
N = N + 400;
z = [y;zeros(size(400))];
f = fstart;

for a = 1:N/(4*M)%a为页数
    figure(a)
    subplot(411)
    plot(z(f:1/Fs:f+M-1))
    f = f+M;
    subplot(412)
    plot(z(f:1/Fs:f+M-1))
    f = f+M;
    subplot(413)
    plot(z(f:1/Fs:f+M-1))
    f = f+M;
    subplot(414)
    plot(z(f:1/Fs:f+M-1))
    f = f+M;
    
end
```



![image-20230221094556169](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230221094556169.png)

<center> Fig.2 Result of strips_modified</center>

Use the supplied MATLAB function *strips_modified.m* to plot all the speech samples in a contiguous format and of a single page.

**vstart = fstart/fs = 2000Hz/8000Hz = 0.25s**

```matlab
strips_modified(y,0.1,0.25,Fs)  %2.33
```



##### Problem 2

![image-20230221094922168](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230221094922168.png)

<center> Fig.3 wn = 0.1</center>

![image-20230222144054224](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230222144054224.png)

<center> Fig.4 wn = 0.3</center>

![image-20230222144119583](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230222144119583.png)

<center> Fig.5 wn = 0.4</center>

As is shown above, with the order coming up, the performance of filter becomes better. wn=0.1 corresponds to the cutoff frequency of 400, 0.3 corresponds to 1200, 0.4 corresponds to 1600, obviously the amplitude of the filter in the cutoff frequency position down to about dichotomous root number two.

```matlab
 fs=8000;
fcut=400;%wn=0.3->1200 wn=0.4->1600


[b, a]=butter(2, fcut/(fs/2));
[h,f]=freqz(b, a, 512, fs);
subplot(311)
plot(f, mag2db(abs(h)));
title('order 2')
axis([0 5000 -50 5]);
xlabel('Frequency (Hz)', 'fontsize', 18)
ylabel('Magnitude', 'fontsize', 18)
grid on

[b, a]=butter(4, fcut/(fs/2));
[h,f]=freqz(b, a, 512, fs);
subplot(312)
plot(f, mag2db(abs(h)));
title('order 4')
axis([0 5000 -50 5]);
xlabel('Frequency (Hz)', 'fontsize', 18)
ylabel('Magnitude', 'fontsize', 18)
grid on

[b, a]=butter(6, fcut/(fs/2));
[h,f]=freqz(b, a, 512, fs);
subplot(313)
plot(f, mag2db(abs(h)));
title('order 6')
axis([0 5000 -50 5]);
xlabel('Frequency (Hz)', 'fontsize', 18)
ylabel('Magnitude', 'fontsize', 18)
grid on
```

![image-20230222150625075](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230222150625075.png)

<center> Fig.6 FilterDesign</center>

##### Problem 3

![image-20230222151657184](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230222151657184.png)

<center> Fig.7 Resample</center>

For some reason, function *rat()* does not work, so I directly use *resample()* to change the fs and plot. In general the amplitude of the signal does not change much, but the number of sampling points varies.

```matlab
[x,Fs] = audioread('mhint_01_01.wav');
subplot(311)
plot(x)
title('Fs = 16000')

% [p,q] = rat(f2, Fs); % f1 to f2
p = 5;
q = 4;
y = resample(x, p, q);
subplot(211)
plot(y)
title('Fs = 20000')

p = 2;
q = 4;
y = resample(x, p, q);
subplot(212)
plot(y)
title('Fs = 8000')
```

![image-20230222152544427](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230222152544427.png)

<center> Fig.8 Interp1()</center>

These two ways to do rate modulation do not have significant difference.

```matlab
[x,Fs] = audioread('mhint_01_01.wav');
subplot(311)
plot(x)
title('Fs = 16000')

t = 1:length(x);
t2 = 1:16000/20000:length(x);
y = interp1(t,x,t2);
subplot(312)
plot(y)
title('Fs = 20000')

t3 = 1:16000/8000:length(x);
y2 = interp1(t,x,t3);
subplot(313)
plot(y2)
title('Fs = 8000')
```



##### Problem 4

![image-20230222152913223](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230222152913223.png)

<center> Fig.9 lowpass filter</center>

![image-20230222153003151](C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230222153003151.png)

<center> Fig.10 highpass filter</center>

In the above filter simulation, I used two methods, one is to simulate the intermediate signal h through the *butter()* and *freqz()* functions, and convolve it with the sound signal to achieve filtering, and the other is to directly use the filter parameters output from FilterDesign to filter through the *filter()* function.





### Conclusion and Comment



Through this lab, I became more familiar with the functions and methods related to processing sound signals in matlab, including how to generate and use filters, how to understand a segment of the sound signal, how to change the sampling frequency and filtering frequency, etc.