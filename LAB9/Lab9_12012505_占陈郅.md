# Lab9_12012505_Âç†ÈôàÈÉÖ



### Purpose of this lab

> 1. Test and understand the statistical model of  speech signal.
>
> 2. Test and understand the process of uniform  quantization.



### Lab results and analysis

#### Problem 1

<img src="C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230421142810998.png" alt="image-20230421142810998" style="zoom:50%;" />



(a)

| histogram of large speech file, bin=25                  | histogram of large speech file, bin=100                 |
| ------------------------------------------------------- | ------------------------------------------------------- |
| ![2](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\2.png) | ![1](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\1.png) |

‚Äã	With more bins, the histogram demonstrates a more significant centering  phenomenon, showing that the speech signal has a density distribution like Laplacian distribution.

(b)

<img src="C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\3.png" alt="3" style="zoom:75%;" />

‚Äã	With a greater window length, the power spectrum of the speech signal shows more  high frequency components, which is because the property of Fourier Transform. Besides, the amplitude of the power spectrum is also greater.

(d)

| ![4](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\4.png) | ![5](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\5.png) |
| ------------------------------------------------------- | ------------------------------------------------------- |

‚Äã	As a different result of the slides, the female voice has a greater amplitude at low  frequency. However, when increase the window length to 256, the amplitude  doesn‚Äôt show a significant greater amplitude at low frequency. Besides, the male  voice has a peak at 2500H Hz, while female voice has a peak at 3000 Hz.

Code

```matlab
% (a)
clc;clear;
signal = [audioread('s1.wav')', audioread('s2.wav')', audioread('s3.wav')', audioread('s4.wav')', audioread('s5.wav')',audioread('s6.wav')']';
min = min(signal);
max = max(signal);
mean = mean(signal);
variance = var(signal);
figure
stem((min:(max-min)/24:max),histogram(signal,25),'Linewidth',10,'Marker','none');
title('histogram of large speech file, bin=25');
figure
stem((min:(max-min)/99:max),histogram(signal,100),'Linewidth',2.5,'Marker','none');
title('histogram of large speech file, bin=100');

% (b)
figure
for i= 1:5
    subplot(3,2,i);pspect(signal, 8000, 1024,16*2^i);
end

% (d)
figure
male = [audioread('s2.wav')', audioread('s4.wav')', audioread('s5.wav')', audioread('s6.wav')']';
female = [audioread('s1.wav')', audioread('s3.wav')']';
hold on; pspect(male, 8000, 1024, 256); pspect(female, 8000, 1024,256); hold off;grid;

```



#### Problem 2

<img src="C:\Users\M__zzZ\AppData\Roaming\Typora\typora-user-images\image-20230421151910566.png" alt="image-20230421151910566" style="zoom:50%;" />

(a)

| ![6](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\6.png) | ![7](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\7.png) |
| ------------------------------------------------------- | ------------------------------------------------------- |

‚Äã	The *fxquant* function is used to quantize a signal with different bit depths and rounding modes. The round mode rounds the quantized value to the nearest representable value, while the trunc mode simply truncates the value. The sat mode ensures that the quantized value is within the representable range, which prevents clipping or overflow. The quantized signals are then plotted to visualize the effect of quantization.

‚Äã	The round quantizer is identical with mid-tread quantizer on the slides, while trunc  quantizer is a little bit different with mid-riser quantizer. The range of quantization error ùëí[ùëõ] is [‚àíŒî/2,Œî/2] for round quantizer, and [Œî , 0] for trunc quantizer.

(b)

![8](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\8.png)

| ![11](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\11.png) | ![9](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\9.png) | ![10](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\10.png) |
| --------------------------------------------------------- | ------------------------------------------------------- | --------------------------------------------------------- |

‚Äã	An audio signal is read from a file and a portion of it is selected. The signal is then quantized with bit depths of 10, 8, and 4 using fxquant, and the quantized signals are stored in signal_quant. The code then computes the error between the original signal and each quantized signal, and plots the error using strips_modified. The error plots show the difference between the original signal and the quantized signal, which represents the error introduced by quantization.

‚Äã	For 10-bit results, it shows an almost perfect reconstruction; But for lower bit  numbers, the signal shows distortion, while the error sequence might be identical  with the signal. This is because the amplitude is smaller than the minimum step size  of the quantizer, thus the whole signal becomes error.  Therefore, sufficient bit number is necessary to avoid huge quantization error.

(c)

![12](C:\Users\M__zzZ\Documents\MATLAB\EE328\LAB9\12.png)

‚Äã	The power spectra of the original signal and the error signals are computed using pspect, and plotted using hold on and hold off. The power spectra show the frequency content of the signals, which can help identify which frequencies are most affected by quantization. 

‚Äã	As a theory of thumb, the greater bit number shows a lower quantization error. According to the slides, we can see the quantization error as a gaussian white distributed error. And when increase for one bit, the SNR will increase for 6dB. We can see on the amplitude of the error signal that its amplitude decreases by 6 dB for every additional bit.

```matlab
clear;clc;
% % (a)
% xin = -1:0.001:1;
% xin_quant = fxquant(xin, 4, 'round', 'sat');
% figure
% plot(xin, xin_quant);grid;title('bit=4, round, sat');
% xin_quant = fxquant(xin, 4, 'trunc', 'sat');
% figure
% plot(xin, xin_quant);grid;title('bit=4, trunc, sat');

% (b)
signal = audioread('s5.wav')';
signal = signal(1300:18800);
signal_quant = zeros(3,length(signal));
bit = [10, 8, 4];
% quantization period
figure;
% subplot(4,1,1);plot(signal);title('original signal');
for i = 1:3
    signal_quant(i,:) = fxquant(signal, bit(i), 'round', 'sat');
%     subplot(4,1,i+1);plot(signal_quant(i,:));title(sprintf('quantized signal with %d bits', bit(i)));
end
% compute error
signal_error = zeros(3,length(signal));
for i = 1:3
    signal_error(i,:) = signal_quant(i,:) - signal;
    error = signal_error(i,:);
    figure
    strips_modified(error(1:8000), 8000, 2000);title(sprintf('error sequence , bit = %d', bit(i)));
%     subplot(3,1,i);plot(error(1:8000));title(sprintf('error sequency , bit = %d', bit(i)));
end

%  (c)
figure;
hold on;pspect(signal, 8000, 1024, 128);
for i = 1:3
    signal_error(i,:) = signal_quant(i,:) - signal;
    error = signal_error(i,:);
	pspect(error, 8000, 1024, 128);title('error signal power spectra');
end
hold off;
```

